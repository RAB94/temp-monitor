2025-06-04 08:30:53,964 - src.utils.logger - INFO - Logging system initialized
2025-06-04 08:30:53,964 - src.utils.logger - INFO - Log level: 20
2025-06-04 08:30:53,964 - src.utils.logger - INFO - Log file: data/logs/network_intelligence.log
2025-06-04 08:30:53,964 - __main__ - INFO - Initializing Enhanced Network Intelligence Monitor with Alloy‚ÜíMimir integration...
2025-06-04 08:30:53,965 - src.config - WARNING - Config file config.yaml not found, using defaults
2025-06-04 08:30:53,965 - src.config - INFO - Configuration validation completed
2025-06-04 08:30:53,965 - __main__ - INFO - Configuration loaded from: config.yaml
2025-06-04 08:30:53,965 - __main__ - INFO - Monitoring targets: ['8.8.8.8', '1.1.1.1', 'google.com']
2025-06-04 08:30:53,965 - __main__ - INFO - Monitoring interval: 30s
2025-06-04 08:30:53,965 - __main__ - INFO - AI features enabled: True
2025-06-04 08:30:53,965 - __main__ - INFO - Edge optimization: False
2025-06-04 08:30:53,965 - __main__ - INFO - Mimir enabled: False
2025-06-04 08:30:53,969 - __main__ - INFO - Environment detection:
2025-06-04 08:30:53,969 - __main__ - INFO -   Platform: linux
2025-06-04 08:30:53,969 - __main__ - INFO -   Is container: True
2025-06-04 08:30:53,969 - __main__ - INFO -   Is cloud: False
2025-06-04 08:30:53,969 - __main__ - INFO -   Is edge device: False
2025-06-04 08:30:53,969 - __main__ - INFO -   Constraints: ['container_limits']
2025-06-04 08:30:53,972 - src.utils.database - INFO - Database tables created
2025-06-04 08:30:53,973 - src.utils.database - INFO - Database indexes created
2025-06-04 08:30:53,973 - src.utils.database - INFO - Database initialized: data/database/network_intelligence.db
2025-06-04 08:30:53,973 - __main__ - INFO - Database initialized: data/database/network_intelligence.db
2025-06-04 08:30:53,973 - src.collector - INFO - Enhanced network collector initialized
2025-06-04 08:30:53,973 - __main__ - INFO - Enhanced network collector initialized
2025-06-04 08:30:54,452 - src.lstm_auto - INFO - Enhanced LSTM anomaly detector initialized
2025-06-04 08:30:54,452 - ai - INFO - Model enhanced_lstm loaded from data/models
2025-06-04 08:30:54,452 - __main__ - INFO - Loaded existing AI models
2025-06-04 08:30:54,452 - __main__ - INFO - AI detection system initialized
2025-06-04 08:30:54,452 - __main__ - INFO - Mimir integration disabled
2025-06-04 08:30:54,452 - src.alerts - INFO - Loaded 0 escalation rules
2025-06-04 08:30:54,452 - src.alerts - INFO - Alert management system started
2025-06-04 08:30:54,452 - __main__ - INFO - Alerting system initialized
2025-06-04 08:30:54,452 - src.dynamic_thresh - INFO - Initialized dynamic thresholds for 10 metrics
2025-06-04 08:30:54,452 - __main__ - INFO - Dynamic threshold management initialized
2025-06-04 08:30:54,454 - src.prom_export - INFO - Prometheus metrics server started on 0.0.0.0:8000
2025-06-04 08:30:54,454 - src.prom_export - INFO - Metrics aggregator started
2025-06-04 08:30:54,454 - __main__ - INFO - Prometheus metrics server started on port 8000 for Alloy to scrape
2025-06-04 08:30:54,457 - __main__ - INFO - Enhanced API server initialized
2025-06-04 08:30:54,459 - websockets.server - INFO - server listening on 0.0.0.0:8001
2025-06-04 08:30:54,460 - src.websocket_server - INFO - WebSocket server started on ws://0.0.0.0:8001
2025-06-04 08:30:54,460 - __main__ - INFO - WebSocket server initialized on port 8001
2025-06-04 08:30:54,460 - __main__ - INFO - Verifying Alloy‚ÜíMimir integration setup...
2025-06-04 08:30:54,462 - __main__ - WARNING - ‚úó Metrics endpoint returned status 404
2025-06-04 08:30:54,462 - __main__ - INFO - ‚úì Alloy configuration file found
2025-06-04 08:30:54,462 - __main__ - WARNING - ‚ö†Ô∏è  Integration setup partially working: 1/3 components operational
2025-06-04 08:30:54,462 - __main__ - INFO - üìã Check Mimir URL and tenant configuration
2025-06-04 08:30:54,462 - __main__ - INFO - Enhanced Network Intelligence Monitor initialization complete
2025-06-04 08:30:54,462 - __main__ - INFO - Starting Enhanced Network Intelligence Monitor...
2025-06-04 08:30:54,462 - __main__ - INFO - Enhanced Network Intelligence Monitor started successfully
2025-06-04 08:30:54,462 - __main__ - INFO - === Enhanced Network Intelligence Monitor Started ===
2025-06-04 08:30:54,462 - __main__ - INFO - API Server: http://0.0.0.0:5000
2025-06-04 08:30:54,462 - __main__ - INFO - Metrics Export (for Alloy): http://0.0.0.0:8000/metrics
2025-06-04 08:30:54,462 - __main__ - INFO - WebSocket Server: ws://0.0.0.0:8001/ws
2025-06-04 08:30:54,462 - __main__ - INFO - Targets: 8.8.8.8, 1.1.1.1, google.com
2025-06-04 08:30:54,462 - __main__ - INFO - AI Detection: Enabled
2025-06-04 08:30:54,462 - __main__ - INFO - Mimir Integration: Disabled
2025-06-04 08:30:54,462 - __main__ - INFO - Edge Optimization: Disabled
2025-06-04 08:30:54,462 - __main__ - INFO - Alerting: Enabled
2025-06-04 08:30:54,462 - __main__ - INFO - =====================================================
2025-06-04 08:30:54,462 - __main__ - INFO - üìä Data Flow: Monitor ‚Üí Alloy (scrapes :8000/metrics)
2025-06-04 08:30:54,462 - __main__ - INFO - Main monitoring loop started
2025-06-04 08:30:54,463 - src.api.server - INFO - Starting API server on 0.0.0.0:5000
2025-06-04 08:31:08,380 - websockets.server - INFO - connection rejected (426 Upgrade Required)
2025-06-04 08:31:08,381 - websockets.server - ERROR - opening handshake failed
Traceback (most recent call last):
  File "/opt/network-monitor-ml/venv/lib/python3.12/site-packages/websockets/asyncio/server.py", line 356, in conn_handler
    await connection.handshake(
  File "/opt/network-monitor-ml/venv/lib/python3.12/site-packages/websockets/asyncio/server.py", line 207, in handshake
    raise self.protocol.handshake_exc
  File "/opt/network-monitor-ml/venv/lib/python3.12/site-packages/websockets/server.py", line 138, in accept
    ) = self.process_request(request)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/network-monitor-ml/venv/lib/python3.12/site-packages/websockets/server.py", line 233, in process_request
    raise InvalidUpgrade(
websockets.exceptions.InvalidUpgrade: missing Connection header
2025-06-04 08:31:12,773 - websockets.server - INFO - connection rejected (426 Upgrade Required)
2025-06-04 08:31:12,775 - websockets.server - ERROR - opening handshake failed
Traceback (most recent call last):
  File "/opt/network-monitor-ml/venv/lib/python3.12/site-packages/websockets/asyncio/server.py", line 356, in conn_handler
    await connection.handshake(
  File "/opt/network-monitor-ml/venv/lib/python3.12/site-packages/websockets/asyncio/server.py", line 207, in handshake
    raise self.protocol.handshake_exc
  File "/opt/network-monitor-ml/venv/lib/python3.12/site-packages/websockets/server.py", line 138, in accept
    ) = self.process_request(request)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/network-monitor-ml/venv/lib/python3.12/site-packages/websockets/server.py", line 233, in process_request
    raise InvalidUpgrade(
websockets.exceptions.InvalidUpgrade: missing Connection header
2025-06-04 08:31:13,678 - src.dynamic_thresh - INFO - Initialized threshold for new metric timestamp: 2623538781.6944914
2025-06-04 08:31:13,678 - src.dynamic_thresh - INFO - Initialized threshold for new metric tcp_connect_time: 10.0
2025-06-04 08:31:13,678 - src.dynamic_thresh - INFO - Initialized threshold for new metric tcp_ssl_handshake_time: 10.0
2025-06-04 08:31:13,678 - src.dynamic_thresh - INFO - Initialized threshold for new metric http_first_byte_time: 10.0
2025-06-04 08:31:13,678 - src.dynamic_thresh - INFO - Initialized threshold for new metric burst_loss_rate: 10.0
2025-06-04 08:31:13,678 - src.dynamic_thresh - INFO - Initialized threshold for new metric out_of_order_packets: 10.0
2025-06-04 08:31:13,678 - src.dynamic_thresh - INFO - Initialized threshold for new metric duplicate_packets: 10.0
2025-06-04 08:31:13,678 - src.dynamic_thresh - INFO - Initialized threshold for new metric bandwidth_upload: 10.0
2025-06-04 08:31:13,678 - src.dynamic_thresh - INFO - Initialized threshold for new metric concurrent_connections: 11
2025-06-04 08:31:13,678 - src.dynamic_thresh - INFO - Initialized threshold for new metric connection_setup_rate: 10.0
2025-06-04 08:31:13,678 - src.dynamic_thresh - INFO - Initialized threshold for new metric http_status_code: 10
2025-06-04 08:31:13,678 - src.dynamic_thresh - INFO - Initialized threshold for new metric http_content_length: 10
2025-06-04 08:31:13,678 - src.dynamic_thresh - INFO - Initialized threshold for new metric certificate_days_remaining: 10
2025-06-04 08:31:13,678 - src.dynamic_thresh - INFO - Initialized threshold for new metric redirect_count: 10
2025-06-04 08:31:13,678 - src.dynamic_thresh - INFO - Initialized threshold for new metric interface_utilization: 10.0
2025-06-04 08:31:13,678 - src.dynamic_thresh - INFO - Initialized threshold for new metric interface_drops: 7786851.0
2025-06-04 08:31:13,678 - src.dynamic_thresh - INFO - Initialized threshold for new metric interface_collisions: 10
2025-06-04 08:31:13,678 - src.dynamic_thresh - INFO - Initialized threshold for new metric hop_count: 17
2025-06-04 08:31:13,678 - src.dynamic_thresh - INFO - Initialized threshold for new metric path_mtu: 2244.0
2025-06-04 08:31:13,678 - src.dynamic_thresh - INFO - Initialized threshold for new metric route_changes: 10
2025-06-04 08:31:13,678 - src.dynamic_thresh - INFO - Initialized threshold for new metric r_factor: 141.25850000000003
2025-06-04 08:31:13,678 - src.dynamic_thresh - INFO - Initialized threshold for new metric delay_variation: 10.334836610237822
2025-06-04 08:31:13,678 - src.dynamic_thresh - INFO - Initialized threshold for new metric dns_errors: 10
2025-06-04 08:31:13,678 - src.dynamic_thresh - INFO - Initialized threshold for new metric timeout_errors: 10
2025-06-04 08:31:13,678 - src.dynamic_thresh - INFO - Initialized threshold for new metric measurement_duration: 28822.030305862427
2025-06-04 08:31:24,430 - __main__ - INFO - Starting periodic AI training...
2025-06-04 08:31:24,430 - __main__ - INFO - Insufficient training data: 3 samples
2025-06-04 08:31:38,380 - websockets.server - INFO - connection rejected (426 Upgrade Required)
2025-06-04 08:31:38,380 - websockets.server - ERROR - opening handshake failed
Traceback (most recent call last):
  File "/opt/network-monitor-ml/venv/lib/python3.12/site-packages/websockets/asyncio/server.py", line 356, in conn_handler
    await connection.handshake(
  File "/opt/network-monitor-ml/venv/lib/python3.12/site-packages/websockets/asyncio/server.py", line 207, in handshake
    raise self.protocol.handshake_exc
  File "/opt/network-monitor-ml/venv/lib/python3.12/site-packages/websockets/server.py", line 138, in accept
    ) = self.process_request(request)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/network-monitor-ml/venv/lib/python3.12/site-packages/websockets/server.py", line 233, in process_request
    raise InvalidUpgrade(
websockets.exceptions.InvalidUpgrade: missing Connection header
2025-06-04 08:31:42,772 - websockets.server - INFO - connection rejected (426 Upgrade Required)
2025-06-04 08:31:42,773 - websockets.server - ERROR - opening handshake failed
Traceback (most recent call last):
  File "/opt/network-monitor-ml/venv/lib/python3.12/site-packages/websockets/asyncio/server.py", line 356, in conn_handler
    await connection.handshake(
  File "/opt/network-monitor-ml/venv/lib/python3.12/site-packages/websockets/asyncio/server.py", line 207, in handshake
    raise self.protocol.handshake_exc
  File "/opt/network-monitor-ml/venv/lib/python3.12/site-packages/websockets/server.py", line 138, in accept
    ) = self.process_request(request)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/network-monitor-ml/venv/lib/python3.12/site-packages/websockets/server.py", line 233, in process_request
    raise InvalidUpgrade(
websockets.exceptions.InvalidUpgrade: missing Connection header
2025-06-04 08:31:59,801 - __main__ - INFO - Starting periodic AI training...
2025-06-04 08:31:59,801 - __main__ - INFO - Insufficient training data: 6 samples
2025-06-04 08:32:06,309 - __main__ - INFO - Received signal 2, initiating graceful shutdown...
2025-06-04 08:32:10,807 - __main__ - INFO - Stopping Enhanced Network Intelligence Monitor...
2025-06-04 08:32:10,808 - __main__ - ERROR - Fatal error: An asyncio.Future, a coroutine or an awaitable is required
2025-06-04 08:32:12,773 - websockets.server - INFO - connection rejected (426 Upgrade Required)
2025-06-04 08:32:12,775 - websockets.server - ERROR - opening handshake failed
Traceback (most recent call last):
  File "/opt/network-monitor-ml/venv/lib/python3.12/site-packages/websockets/asyncio/server.py", line 356, in conn_handler
    await connection.handshake(
  File "/opt/network-monitor-ml/venv/lib/python3.12/site-packages/websockets/asyncio/server.py", line 207, in handshake
    raise self.protocol.handshake_exc
  File "/opt/network-monitor-ml/venv/lib/python3.12/site-packages/websockets/server.py", line 138, in accept
    ) = self.process_request(request)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/network-monitor-ml/venv/lib/python3.12/site-packages/websockets/server.py", line 233, in process_request
    raise InvalidUpgrade(
websockets.exceptions.InvalidUpgrade: missing Connection header
2025-06-04 08:32:14,226 - __main__ - INFO - Received signal 2, initiating graceful shutdown...
2025-06-04 08:32:14,727 - __main__ - INFO - Received signal 2, initiating graceful shutdown...
2025-06-04 08:32:14,990 - __main__ - INFO - Received signal 2, initiating graceful shutdown...
2025-06-04 08:32:15,203 - __main__ - INFO - Received signal 2, initiating graceful shutdown...
2025-06-04 08:32:15,401 - __main__ - INFO - Received signal 2, initiating graceful shutdown...
2025-06-04 08:32:15,577 - __main__ - INFO - Received signal 2, initiating graceful shutdown...
2025-06-04 08:32:18,935 - __main__ - INFO - Received signal 2, initiating graceful shutdown...
2025-06-04 08:32:38,380 - websockets.server - INFO - connection rejected (426 Upgrade Required)
2025-06-04 08:32:38,381 - websockets.server - ERROR - opening handshake failed
Traceback (most recent call last):
  File "/opt/network-monitor-ml/venv/lib/python3.12/site-packages/websockets/asyncio/server.py", line 356, in conn_handler
    await connection.handshake(
  File "/opt/network-monitor-ml/venv/lib/python3.12/site-packages/websockets/asyncio/server.py", line 207, in handshake
    raise self.protocol.handshake_exc
  File "/opt/network-monitor-ml/venv/lib/python3.12/site-packages/websockets/server.py", line 138, in accept
    ) = self.process_request(request)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/network-monitor-ml/venv/lib/python3.12/site-packages/websockets/server.py", line 233, in process_request
    raise InvalidUpgrade(
websockets.exceptions.InvalidUpgrade: missing Connection header
2025-06-04 08:32:42,773 - websockets.server - INFO - connection rejected (426 Upgrade Required)
2025-06-04 08:32:42,776 - websockets.server - ERROR - opening handshake failed
Traceback (most recent call last):
  File "/opt/network-monitor-ml/venv/lib/python3.12/site-packages/websockets/asyncio/server.py", line 356, in conn_handler
    await connection.handshake(
  File "/opt/network-monitor-ml/venv/lib/python3.12/site-packages/websockets/asyncio/server.py", line 207, in handshake
    raise self.protocol.handshake_exc
  File "/opt/network-monitor-ml/venv/lib/python3.12/site-packages/websockets/server.py", line 138, in accept
    ) = self.process_request(request)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/network-monitor-ml/venv/lib/python3.12/site-packages/websockets/server.py", line 233, in process_request
    raise InvalidUpgrade(
websockets.exceptions.InvalidUpgrade: missing Connection header
2025-06-04 08:33:03,598 - __main__ - INFO - Received signal 2, initiating graceful shutdown...
2025-06-04 08:33:03,824 - __main__ - INFO - Received signal 2, initiating graceful shutdown...
2025-06-04 08:33:04,016 - __main__ - INFO - Received signal 2, initiating graceful shutdown...
2025-06-04 08:33:04,187 - __main__ - INFO - Received signal 2, initiating graceful shutdown...
2025-06-04 08:33:04,363 - __main__ - INFO - Received signal 2, initiating graceful shutdown...
2025-06-04 08:33:04,554 - __main__ - INFO - Received signal 2, initiating graceful shutdown...
2025-06-04 08:33:04,740 - __main__ - INFO - Received signal 2, initiating graceful shutdown...
2025-06-04 08:33:04,913 - __main__ - INFO - Received signal 2, initiating graceful shutdown...
2025-06-04 08:33:05,059 - __main__ - INFO - Received signal 2, initiating graceful shutdown...
2025-06-04 08:33:05,263 - __main__ - INFO - Received signal 2, initiating graceful shutdown...
2025-06-04 08:33:05,409 - __main__ - INFO - Received signal 2, initiating graceful shutdown...
2025-06-04 08:33:08,380 - websockets.server - INFO - connection rejected (426 Upgrade Required)
2025-06-04 08:33:08,381 - websockets.server - ERROR - opening handshake failed
Traceback (most recent call last):
  File "/opt/network-monitor-ml/venv/lib/python3.12/site-packages/websockets/asyncio/server.py", line 356, in conn_handler
    await connection.handshake(
  File "/opt/network-monitor-ml/venv/lib/python3.12/site-packages/websockets/asyncio/server.py", line 207, in handshake
    raise self.protocol.handshake_exc
  File "/opt/network-monitor-ml/venv/lib/python3.12/site-packages/websockets/server.py", line 138, in accept
    ) = self.process_request(request)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/network-monitor-ml/venv/lib/python3.12/site-packages/websockets/server.py", line 233, in process_request
    raise InvalidUpgrade(
websockets.exceptions.InvalidUpgrade: missing Connection header
2025-06-04 08:33:09,405 - __main__ - INFO - Received signal 2, initiating graceful shutdown...
2025-06-04 08:33:09,632 - __main__ - INFO - Received signal 2, initiating graceful shutdown...
2025-06-04 08:33:09,823 - __main__ - INFO - Received signal 2, initiating graceful shutdown...
2025-06-04 08:33:10,013 - __main__ - INFO - Received signal 2, initiating graceful shutdown...
2025-06-04 08:33:12,773 - websockets.server - INFO - connection rejected (426 Upgrade Required)
2025-06-04 08:33:12,774 - websockets.server - ERROR - opening handshake failed
Traceback (most recent call last):
  File "/opt/network-monitor-ml/venv/lib/python3.12/site-packages/websockets/asyncio/server.py", line 356, in conn_handler
    await connection.handshake(
  File "/opt/network-monitor-ml/venv/lib/python3.12/site-packages/websockets/asyncio/server.py", line 207, in handshake
    raise self.protocol.handshake_exc
  File "/opt/network-monitor-ml/venv/lib/python3.12/site-packages/websockets/server.py", line 138, in accept
    ) = self.process_request(request)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/network-monitor-ml/venv/lib/python3.12/site-packages/websockets/server.py", line 233, in process_request
    raise InvalidUpgrade(
websockets.exceptions.InvalidUpgrade: missing Connection header
2025-06-04 08:33:17,381 - __main__ - INFO - Received signal 2, initiating graceful shutdown...
2025-06-04 08:33:38,380 - websockets.server - INFO - connection rejected (426 Upgrade Required)
2025-06-04 08:33:38,382 - websockets.server - ERROR - opening handshake failed
Traceback (most recent call last):
  File "/opt/network-monitor-ml/venv/lib/python3.12/site-packages/websockets/asyncio/server.py", line 356, in conn_handler
    await connection.handshake(
  File "/opt/network-monitor-ml/venv/lib/python3.12/site-packages/websockets/asyncio/server.py", line 207, in handshake
    raise self.protocol.handshake_exc
  File "/opt/network-monitor-ml/venv/lib/python3.12/site-packages/websockets/server.py", line 138, in accept
    ) = self.process_request(request)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/network-monitor-ml/venv/lib/python3.12/site-packages/websockets/server.py", line 233, in process_request
    raise InvalidUpgrade(
websockets.exceptions.InvalidUpgrade: missing Connection header
2025-06-04 08:33:42,772 - websockets.server - INFO - connection rejected (426 Upgrade Required)
2025-06-04 08:33:42,775 - websockets.server - ERROR - opening handshake failed
Traceback (most recent call last):
  File "/opt/network-monitor-ml/venv/lib/python3.12/site-packages/websockets/asyncio/server.py", line 356, in conn_handler
    await connection.handshake(
  File "/opt/network-monitor-ml/venv/lib/python3.12/site-packages/websockets/asyncio/server.py", line 207, in handshake
    raise self.protocol.handshake_exc
  File "/opt/network-monitor-ml/venv/lib/python3.12/site-packages/websockets/server.py", line 138, in accept
    ) = self.process_request(request)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/network-monitor-ml/venv/lib/python3.12/site-packages/websockets/server.py", line 233, in process_request
    raise InvalidUpgrade(
websockets.exceptions.InvalidUpgrade: missing Connection header
2025-06-04 08:34:08,379 - websockets.server - INFO - connection rejected (426 Upgrade Required)
2025-06-04 08:34:08,380 - websockets.server - ERROR - opening handshake failed
Traceback (most recent call last):
  File "/opt/network-monitor-ml/venv/lib/python3.12/site-packages/websockets/asyncio/server.py", line 356, in conn_handler
    await connection.handshake(
  File "/opt/network-monitor-ml/venv/lib/python3.12/site-packages/websockets/asyncio/server.py", line 207, in handshake
    raise self.protocol.handshake_exc
  File "/opt/network-monitor-ml/venv/lib/python3.12/site-packages/websockets/server.py", line 138, in accept
    ) = self.process_request(request)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/network-monitor-ml/venv/lib/python3.12/site-packages/websockets/server.py", line 233, in process_request
    raise InvalidUpgrade(
websockets.exceptions.InvalidUpgrade: missing Connection header
2025-06-04 08:34:12,772 - websockets.server - INFO - connection rejected (426 Upgrade Required)
2025-06-04 08:34:12,773 - websockets.server - ERROR - opening handshake failed
Traceback (most recent call last):
  File "/opt/network-monitor-ml/venv/lib/python3.12/site-packages/websockets/asyncio/server.py", line 356, in conn_handler
    await connection.handshake(
  File "/opt/network-monitor-ml/venv/lib/python3.12/site-packages/websockets/asyncio/server.py", line 207, in handshake
    raise self.protocol.handshake_exc
  File "/opt/network-monitor-ml/venv/lib/python3.12/site-packages/websockets/server.py", line 138, in accept
    ) = self.process_request(request)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/network-monitor-ml/venv/lib/python3.12/site-packages/websockets/server.py", line 233, in process_request
    raise InvalidUpgrade(
websockets.exceptions.InvalidUpgrade: missing Connection header
2025-06-04 08:34:38,380 - websockets.server - INFO - connection rejected (426 Upgrade Required)
2025-06-04 08:34:38,382 - websockets.server - ERROR - opening handshake failed
Traceback (most recent call last):
  File "/opt/network-monitor-ml/venv/lib/python3.12/site-packages/websockets/asyncio/server.py", line 356, in conn_handler
    await connection.handshake(
  File "/opt/network-monitor-ml/venv/lib/python3.12/site-packages/websockets/asyncio/server.py", line 207, in handshake
    raise self.protocol.handshake_exc
  File "/opt/network-monitor-ml/venv/lib/python3.12/site-packages/websockets/server.py", line 138, in accept
    ) = self.process_request(request)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/network-monitor-ml/venv/lib/python3.12/site-packages/websockets/server.py", line 233, in process_request
    raise InvalidUpgrade(
websockets.exceptions.InvalidUpgrade: missing Connection header
2025-06-04 08:34:42,772 - websockets.server - INFO - connection rejected (426 Upgrade Required)
2025-06-04 08:34:42,773 - websockets.server - ERROR - opening handshake failed
Traceback (most recent call last):
  File "/opt/network-monitor-ml/venv/lib/python3.12/site-packages/websockets/asyncio/server.py", line 356, in conn_handler
    await connection.handshake(
  File "/opt/network-monitor-ml/venv/lib/python3.12/site-packages/websockets/asyncio/server.py", line 207, in handshake
    raise self.protocol.handshake_exc
  File "/opt/network-monitor-ml/venv/lib/python3.12/site-packages/websockets/server.py", line 138, in accept
    ) = self.process_request(request)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/network-monitor-ml/venv/lib/python3.12/site-packages/websockets/server.py", line 233, in process_request
    raise InvalidUpgrade(
websockets.exceptions.InvalidUpgrade: missing Connection header
2025-06-04 08:35:08,380 - websockets.server - INFO - connection rejected (426 Upgrade Required)
2025-06-04 08:35:08,382 - websockets.server - ERROR - opening handshake failed
Traceback (most recent call last):
  File "/opt/network-monitor-ml/venv/lib/python3.12/site-packages/websockets/asyncio/server.py", line 356, in conn_handler
    await connection.handshake(
  File "/opt/network-monitor-ml/venv/lib/python3.12/site-packages/websockets/asyncio/server.py", line 207, in handshake
    raise self.protocol.handshake_exc
  File "/opt/network-monitor-ml/venv/lib/python3.12/site-packages/websockets/server.py", line 138, in accept
    ) = self.process_request(request)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/network-monitor-ml/venv/lib/python3.12/site-packages/websockets/server.py", line 233, in process_request
    raise InvalidUpgrade(
websockets.exceptions.InvalidUpgrade: missing Connection header
2025-06-04 08:35:12,773 - websockets.server - INFO - connection rejected (426 Upgrade Required)
2025-06-04 08:35:12,774 - websockets.server - ERROR - opening handshake failed
Traceback (most recent call last):
  File "/opt/network-monitor-ml/venv/lib/python3.12/site-packages/websockets/asyncio/server.py", line 356, in conn_handler
    await connection.handshake(
  File "/opt/network-monitor-ml/venv/lib/python3.12/site-packages/websockets/asyncio/server.py", line 207, in handshake
    raise self.protocol.handshake_exc
  File "/opt/network-monitor-ml/venv/lib/python3.12/site-packages/websockets/server.py", line 138, in accept
    ) = self.process_request(request)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/network-monitor-ml/venv/lib/python3.12/site-packages/websockets/server.py", line 233, in process_request
    raise InvalidUpgrade(
websockets.exceptions.InvalidUpgrade: missing Connection header
2025-06-04 08:35:38,382 - websockets.server - INFO - connection rejected (426 Upgrade Required)
2025-06-04 08:35:38,383 - websockets.server - ERROR - opening handshake failed
Traceback (most recent call last):
  File "/opt/network-monitor-ml/venv/lib/python3.12/site-packages/websockets/asyncio/server.py", line 356, in conn_handler
    await connection.handshake(
  File "/opt/network-monitor-ml/venv/lib/python3.12/site-packages/websockets/asyncio/server.py", line 207, in handshake
    raise self.protocol.handshake_exc
  File "/opt/network-monitor-ml/venv/lib/python3.12/site-packages/websockets/server.py", line 138, in accept
    ) = self.process_request(request)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/network-monitor-ml/venv/lib/python3.12/site-packages/websockets/server.py", line 233, in process_request
    raise InvalidUpgrade(
websockets.exceptions.InvalidUpgrade: missing Connection header
2025-06-04 08:35:42,772 - websockets.server - INFO - connection rejected (426 Upgrade Required)
2025-06-04 08:35:42,774 - websockets.server - ERROR - opening handshake failed
Traceback (most recent call last):
  File "/opt/network-monitor-ml/venv/lib/python3.12/site-packages/websockets/asyncio/server.py", line 356, in conn_handler
    await connection.handshake(
  File "/opt/network-monitor-ml/venv/lib/python3.12/site-packages/websockets/asyncio/server.py", line 207, in handshake
    raise self.protocol.handshake_exc
  File "/opt/network-monitor-ml/venv/lib/python3.12/site-packages/websockets/server.py", line 138, in accept
    ) = self.process_request(request)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/network-monitor-ml/venv/lib/python3.12/site-packages/websockets/server.py", line 233, in process_request
    raise InvalidUpgrade(
websockets.exceptions.InvalidUpgrade: missing Connection header
2025-06-04 08:36:08,381 - websockets.server - INFO - connection rejected (426 Upgrade Required)
2025-06-04 08:36:08,382 - websockets.server - ERROR - opening handshake failed
Traceback (most recent call last):
  File "/opt/network-monitor-ml/venv/lib/python3.12/site-packages/websockets/asyncio/server.py", line 356, in conn_handler
    await connection.handshake(
  File "/opt/network-monitor-ml/venv/lib/python3.12/site-packages/websockets/asyncio/server.py", line 207, in handshake
    raise self.protocol.handshake_exc
  File "/opt/network-monitor-ml/venv/lib/python3.12/site-packages/websockets/server.py", line 138, in accept
    ) = self.process_request(request)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/network-monitor-ml/venv/lib/python3.12/site-packages/websockets/server.py", line 233, in process_request
    raise InvalidUpgrade(
websockets.exceptions.InvalidUpgrade: missing Connection header
2025-06-04 08:36:12,773 - websockets.server - INFO - connection rejected (426 Upgrade Required)
2025-06-04 08:36:12,775 - websockets.server - ERROR - opening handshake failed
Traceback (most recent call last):
  File "/opt/network-monitor-ml/venv/lib/python3.12/site-packages/websockets/asyncio/server.py", line 356, in conn_handler
    await connection.handshake(
  File "/opt/network-monitor-ml/venv/lib/python3.12/site-packages/websockets/asyncio/server.py", line 207, in handshake
    raise self.protocol.handshake_exc
  File "/opt/network-monitor-ml/venv/lib/python3.12/site-packages/websockets/server.py", line 138, in accept
    ) = self.process_request(request)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/network-monitor-ml/venv/lib/python3.12/site-packages/websockets/server.py", line 233, in process_request
    raise InvalidUpgrade(
websockets.exceptions.InvalidUpgrade: missing Connection header
2025-06-04 08:36:38,380 - websockets.server - INFO - connection rejected (426 Upgrade Required)
2025-06-04 08:36:38,381 - websockets.server - ERROR - opening handshake failed
Traceback (most recent call last):
  File "/opt/network-monitor-ml/venv/lib/python3.12/site-packages/websockets/asyncio/server.py", line 356, in conn_handler
    await connection.handshake(
  File "/opt/network-monitor-ml/venv/lib/python3.12/site-packages/websockets/asyncio/server.py", line 207, in handshake
    raise self.protocol.handshake_exc
  File "/opt/network-monitor-ml/venv/lib/python3.12/site-packages/websockets/server.py", line 138, in accept
    ) = self.process_request(request)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/network-monitor-ml/venv/lib/python3.12/site-packages/websockets/server.py", line 233, in process_request
    raise InvalidUpgrade(
websockets.exceptions.InvalidUpgrade: missing Connection header
2025-06-04 08:36:42,773 - websockets.server - INFO - connection rejected (426 Upgrade Required)
2025-06-04 08:36:42,775 - websockets.server - ERROR - opening handshake failed
Traceback (most recent call last):
  File "/opt/network-monitor-ml/venv/lib/python3.12/site-packages/websockets/asyncio/server.py", line 356, in conn_handler
    await connection.handshake(
  File "/opt/network-monitor-ml/venv/lib/python3.12/site-packages/websockets/asyncio/server.py", line 207, in handshake
    raise self.protocol.handshake_exc
  File "/opt/network-monitor-ml/venv/lib/python3.12/site-packages/websockets/server.py", line 138, in accept
    ) = self.process_request(request)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/network-monitor-ml/venv/lib/python3.12/site-packages/websockets/server.py", line 233, in process_request
    raise InvalidUpgrade(
websockets.exceptions.InvalidUpgrade: missing Connection header
2025-06-04 08:37:08,380 - websockets.server - INFO - connection rejected (426 Upgrade Required)
2025-06-04 08:37:08,382 - websockets.server - ERROR - opening handshake failed
Traceback (most recent call last):
  File "/opt/network-monitor-ml/venv/lib/python3.12/site-packages/websockets/asyncio/server.py", line 356, in conn_handler
    await connection.handshake(
  File "/opt/network-monitor-ml/venv/lib/python3.12/site-packages/websockets/asyncio/server.py", line 207, in handshake
    raise self.protocol.handshake_exc
  File "/opt/network-monitor-ml/venv/lib/python3.12/site-packages/websockets/server.py", line 138, in accept
    ) = self.process_request(request)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/network-monitor-ml/venv/lib/python3.12/site-packages/websockets/server.py", line 233, in process_request
    raise InvalidUpgrade(
websockets.exceptions.InvalidUpgrade: missing Connection header
2025-06-04 08:38:25,951 - __main__ - INFO - Received signal 15, initiating graceful shutdown...
2025-06-04 08:39:24,449 - src.utils.logger - INFO - Logging system initialized
2025-06-04 08:39:24,450 - src.utils.logger - INFO - Log level: 20
2025-06-04 08:39:24,450 - src.utils.logger - INFO - Log file: data/logs/network_intelligence.log
2025-06-04 08:39:24,450 - __main__ - INFO - Initializing Enhanced Network Intelligence Monitor with Alloy‚ÜíMimir integration...
2025-06-04 08:39:24,451 - src.config - INFO - Loaded configuration from config.yaml
2025-06-04 08:39:24,451 - src.config - INFO - Configuration validation completed
2025-06-04 08:39:24,451 - __main__ - INFO - Configuration loaded from: config.yaml
2025-06-04 08:39:24,451 - __main__ - INFO - Monitoring targets: ['8.8.8.8', '1.1.1.1', 'google.com', 'github.com']
2025-06-04 08:39:24,451 - __main__ - INFO - Monitoring interval: 30s
2025-06-04 08:39:24,451 - __main__ - INFO - AI features enabled: True
2025-06-04 08:39:24,451 - __main__ - INFO - Edge optimization: False
2025-06-04 08:39:24,451 - __main__ - INFO - Mimir enabled: True
2025-06-04 08:39:24,453 - __main__ - INFO - Environment detection:
2025-06-04 08:39:24,453 - __main__ - INFO -   Platform: linux
2025-06-04 08:39:24,453 - __main__ - INFO -   Is container: True
2025-06-04 08:39:24,453 - __main__ - INFO -   Is cloud: False
2025-06-04 08:39:24,453 - __main__ - INFO -   Is edge device: False
2025-06-04 08:39:24,453 - __main__ - INFO -   Constraints: ['container_limits']
2025-06-04 08:39:24,454 - src.utils.database - INFO - Database tables created
2025-06-04 08:39:24,455 - src.utils.database - INFO - Database indexes created
2025-06-04 08:39:24,455 - src.utils.database - INFO - Database initialized: data/database/network_intelligence.db
2025-06-04 08:39:24,455 - __main__ - INFO - Database initialized: data/database/network_intelligence.db
2025-06-04 08:39:24,455 - src.collector - INFO - Enhanced network collector initialized
2025-06-04 08:39:24,455 - __main__ - INFO - Enhanced network collector initialized
2025-06-04 08:39:24,933 - src.lstm_auto - INFO - Enhanced LSTM anomaly detector initialized
2025-06-04 08:39:24,933 - ai - INFO - Model enhanced_lstm loaded from data/models
2025-06-04 08:39:24,939 - __main__ - INFO - Loaded existing AI models
2025-06-04 08:39:24,939 - __main__ - INFO - AI detection system initialized
2025-06-04 08:39:24,939 - src.mimir_integration - INFO - Mimir client initialized
2025-06-04 08:39:24,939 - __main__ - INFO - Mimir connectivity: {'mimir': {'status': 'error', 'error': '$%7BMIMIR_URL%7D/api/v1/query'}}
2025-06-04 08:39:24,939 - src.mimir_integration - INFO - Fetching historical baselines from Mimir...
2025-06-04 08:39:24,939 - src.mimir_integration - INFO - Creating baselines from 30 days of historical data
2025-06-04 08:39:24,939 - src.mimir_integration - ERROR - Failed to create baseline for avg_over_time(network_icmp_ping_duration_seconds{target=~"8.8.8.8"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:39:24,939 - src.mimir_integration - ERROR - Failed to create baseline for avg_over_time(network_packet_loss_ratio{target=~"8.8.8.8"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:39:24,939 - src.mimir_integration - ERROR - Failed to create baseline for avg_over_time(network_jitter_seconds{target=~"8.8.8.8"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:39:24,939 - src.mimir_integration - ERROR - Failed to create baseline for avg_over_time(network_mos_score{target=~"8.8.8.8"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:39:24,939 - src.mimir_integration - ERROR - Failed to create baseline for avg_over_time(network_tcp_handshake_duration_seconds{target=~"8.8.8.8"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:39:24,939 - src.mimir_integration - ERROR - Failed to create baseline for avg_over_time(network_dns_resolution_duration_seconds{target=~"8.8.8.8"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:39:24,939 - src.mimir_integration - ERROR - Failed to create baseline for avg_over_time(network_http_response_duration_seconds{target=~"8.8.8.8"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:39:24,939 - src.mimir_integration - ERROR - Failed to create baseline for rate(network_connection_errors_total{target=~"8.8.8.8"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:39:24,939 - src.mimir_integration - ERROR - Failed to create baseline for avg_over_time(network_interface_utilization_ratio{interface=~".*"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:39:24,939 - src.mimir_integration - ERROR - Failed to create baseline for avg_over_time(network_icmp_ping_duration_seconds{target=~"1.1.1.1"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:39:24,939 - src.mimir_integration - ERROR - Failed to create baseline for avg_over_time(network_packet_loss_ratio{target=~"1.1.1.1"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:39:24,939 - src.mimir_integration - ERROR - Failed to create baseline for avg_over_time(network_jitter_seconds{target=~"1.1.1.1"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:39:24,939 - src.mimir_integration - ERROR - Failed to create baseline for avg_over_time(network_mos_score{target=~"1.1.1.1"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:39:24,939 - src.mimir_integration - ERROR - Failed to create baseline for avg_over_time(network_tcp_handshake_duration_seconds{target=~"1.1.1.1"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:39:24,939 - src.mimir_integration - ERROR - Failed to create baseline for avg_over_time(network_dns_resolution_duration_seconds{target=~"1.1.1.1"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:39:24,939 - src.mimir_integration - ERROR - Failed to create baseline for avg_over_time(network_http_response_duration_seconds{target=~"1.1.1.1"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:39:24,939 - src.mimir_integration - ERROR - Failed to create baseline for rate(network_connection_errors_total{target=~"1.1.1.1"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:39:24,939 - src.mimir_integration - ERROR - Failed to create baseline for avg_over_time(network_interface_utilization_ratio{interface=~".*"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:39:24,940 - src.mimir_integration - ERROR - Failed to create baseline for avg_over_time(network_icmp_ping_duration_seconds{target=~"google.com"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:39:24,940 - src.mimir_integration - ERROR - Failed to create baseline for avg_over_time(network_packet_loss_ratio{target=~"google.com"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:39:24,940 - src.mimir_integration - ERROR - Failed to create baseline for avg_over_time(network_jitter_seconds{target=~"google.com"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:39:24,940 - src.mimir_integration - ERROR - Failed to create baseline for avg_over_time(network_mos_score{target=~"google.com"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:39:24,940 - src.mimir_integration - ERROR - Failed to create baseline for avg_over_time(network_tcp_handshake_duration_seconds{target=~"google.com"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:39:24,940 - src.mimir_integration - ERROR - Failed to create baseline for avg_over_time(network_dns_resolution_duration_seconds{target=~"google.com"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:39:24,940 - src.mimir_integration - ERROR - Failed to create baseline for avg_over_time(network_http_response_duration_seconds{target=~"google.com"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:39:24,940 - src.mimir_integration - ERROR - Failed to create baseline for rate(network_connection_errors_total{target=~"google.com"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:39:24,940 - src.mimir_integration - ERROR - Failed to create baseline for avg_over_time(network_interface_utilization_ratio{interface=~".*"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:39:24,940 - src.mimir_integration - ERROR - Failed to create baseline for avg_over_time(network_icmp_ping_duration_seconds{target=~"github.com"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:39:24,940 - src.mimir_integration - ERROR - Failed to create baseline for avg_over_time(network_packet_loss_ratio{target=~"github.com"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:39:24,940 - src.mimir_integration - ERROR - Failed to create baseline for avg_over_time(network_jitter_seconds{target=~"github.com"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:39:24,940 - src.mimir_integration - ERROR - Failed to create baseline for avg_over_time(network_mos_score{target=~"github.com"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:39:24,940 - src.mimir_integration - ERROR - Failed to create baseline for avg_over_time(network_tcp_handshake_duration_seconds{target=~"github.com"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:39:24,940 - src.mimir_integration - ERROR - Failed to create baseline for avg_over_time(network_dns_resolution_duration_seconds{target=~"github.com"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:39:24,940 - src.mimir_integration - ERROR - Failed to create baseline for avg_over_time(network_http_response_duration_seconds{target=~"github.com"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:39:24,940 - src.mimir_integration - ERROR - Failed to create baseline for rate(network_connection_errors_total{target=~"github.com"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:39:24,940 - src.mimir_integration - ERROR - Failed to create baseline for avg_over_time(network_interface_utilization_ratio{interface=~".*"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:39:24,940 - src.mimir_integration - WARNING - No baselines retrieved from Mimir
2025-06-04 08:39:24,940 - __main__ - INFO - Mimir integration initialized
2025-06-04 08:39:24,940 - src.alerts - INFO - Loaded 0 escalation rules
2025-06-04 08:39:24,940 - src.alerts - INFO - Alert management system started
2025-06-04 08:39:24,940 - __main__ - INFO - Alerting system initialized
2025-06-04 08:39:24,940 - src.dynamic_thresh - INFO - Initialized dynamic thresholds for 10 metrics
2025-06-04 08:39:24,940 - __main__ - INFO - Dynamic threshold management initialized
2025-06-04 08:39:24,941 - src.prom_export - INFO - Prometheus metrics server started on 0.0.0.0:8540
2025-06-04 08:39:24,942 - src.prom_export - INFO - Metrics aggregator started
2025-06-04 08:39:24,942 - __main__ - INFO - Prometheus metrics server started on port 8540 for Alloy to scrape
2025-06-04 08:39:24,945 - __main__ - INFO - Enhanced API server initialized
2025-06-04 08:39:24,948 - websockets.server - INFO - server listening on 0.0.0.0:8001
2025-06-04 08:39:24,948 - src.websocket_server - INFO - WebSocket server started on ws://0.0.0.0:8001
2025-06-04 08:39:24,948 - __main__ - INFO - WebSocket server initialized on port 8001
2025-06-04 08:39:24,948 - __main__ - INFO - Verifying Alloy‚ÜíMimir integration setup...
2025-06-04 08:39:24,950 - __main__ - INFO - ‚úì Metrics export endpoint working
2025-06-04 08:39:24,950 - __main__ - WARNING - ‚úó Mimir connectivity failed
2025-06-04 08:39:24,950 - __main__ - INFO - ‚úì Alloy configuration file found
2025-06-04 08:39:24,950 - __main__ - WARNING - ‚ö†Ô∏è  Integration setup partially working: 2/3 components operational
2025-06-04 08:39:24,950 - __main__ - INFO - üìã Check Mimir URL and tenant configuration
2025-06-04 08:39:24,950 - __main__ - INFO - Enhanced Network Intelligence Monitor initialization complete
2025-06-04 08:39:24,950 - __main__ - INFO - Starting Enhanced Network Intelligence Monitor...
2025-06-04 08:39:24,951 - __main__ - INFO - Enhanced Network Intelligence Monitor started successfully
2025-06-04 08:39:24,951 - __main__ - INFO - === Enhanced Network Intelligence Monitor Started ===
2025-06-04 08:39:24,951 - __main__ - INFO - API Server: http://0.0.0.0:5000
2025-06-04 08:39:24,951 - __main__ - INFO - Metrics Export (for Alloy): http://0.0.0.0:8540/metrics
2025-06-04 08:39:24,951 - __main__ - INFO - WebSocket Server: ws://0.0.0.0:8001/ws
2025-06-04 08:39:24,951 - __main__ - INFO - Targets: 8.8.8.8, 1.1.1.1, google.com, github.com
2025-06-04 08:39:24,951 - __main__ - INFO - AI Detection: Enabled
2025-06-04 08:39:24,951 - __main__ - INFO - Mimir Integration: Enabled
2025-06-04 08:39:24,951 - __main__ - INFO - Edge Optimization: Disabled
2025-06-04 08:39:24,951 - __main__ - INFO - Alerting: Enabled
2025-06-04 08:39:24,951 - __main__ - INFO - =====================================================
2025-06-04 08:39:24,951 - __main__ - INFO - üìä Data Flow: Monitor ‚Üí Alloy (scrapes :8000/metrics) ‚Üí Mimir
2025-06-04 08:39:24,951 - __main__ - INFO - Main monitoring loop started
2025-06-04 08:39:24,951 - __main__ - INFO - Updating baselines from Mimir...
2025-06-04 08:39:24,951 - src.mimir_integration - INFO - Creating baselines from 7 days of historical data
2025-06-04 08:39:24,951 - src.api.server - INFO - Starting API server on 0.0.0.0:5000
2025-06-04 08:39:24,951 - src.mimir_integration - ERROR - Failed to create baseline for avg_over_time(network_icmp_ping_duration_seconds{target=~"8.8.8.8"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:39:24,951 - src.mimir_integration - ERROR - Failed to create baseline for avg_over_time(network_packet_loss_ratio{target=~"8.8.8.8"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:39:24,951 - src.mimir_integration - ERROR - Failed to create baseline for avg_over_time(network_jitter_seconds{target=~"8.8.8.8"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:39:24,951 - src.mimir_integration - ERROR - Failed to create baseline for avg_over_time(network_mos_score{target=~"8.8.8.8"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:39:24,951 - src.mimir_integration - ERROR - Failed to create baseline for avg_over_time(network_tcp_handshake_duration_seconds{target=~"8.8.8.8"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:39:24,951 - src.mimir_integration - ERROR - Failed to create baseline for avg_over_time(network_dns_resolution_duration_seconds{target=~"8.8.8.8"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:39:24,952 - src.mimir_integration - ERROR - Failed to create baseline for avg_over_time(network_http_response_duration_seconds{target=~"8.8.8.8"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:39:24,952 - src.mimir_integration - ERROR - Failed to create baseline for rate(network_connection_errors_total{target=~"8.8.8.8"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:39:24,952 - src.mimir_integration - ERROR - Failed to create baseline for avg_over_time(network_interface_utilization_ratio{interface=~".*"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:39:24,952 - src.mimir_integration - ERROR - Failed to create baseline for avg_over_time(network_icmp_ping_duration_seconds{target=~"1.1.1.1"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:39:24,952 - src.mimir_integration - ERROR - Failed to create baseline for avg_over_time(network_packet_loss_ratio{target=~"1.1.1.1"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:39:24,952 - src.mimir_integration - ERROR - Failed to create baseline for avg_over_time(network_jitter_seconds{target=~"1.1.1.1"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:39:24,952 - src.mimir_integration - ERROR - Failed to create baseline for avg_over_time(network_mos_score{target=~"1.1.1.1"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:39:24,952 - src.mimir_integration - ERROR - Failed to create baseline for avg_over_time(network_tcp_handshake_duration_seconds{target=~"1.1.1.1"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:39:24,952 - src.mimir_integration - ERROR - Failed to create baseline for avg_over_time(network_dns_resolution_duration_seconds{target=~"1.1.1.1"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:39:24,952 - src.mimir_integration - ERROR - Failed to create baseline for avg_over_time(network_http_response_duration_seconds{target=~"1.1.1.1"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:39:24,952 - src.mimir_integration - ERROR - Failed to create baseline for rate(network_connection_errors_total{target=~"1.1.1.1"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:39:24,952 - src.mimir_integration - ERROR - Failed to create baseline for avg_over_time(network_interface_utilization_ratio{interface=~".*"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:39:24,952 - src.mimir_integration - ERROR - Failed to create baseline for avg_over_time(network_icmp_ping_duration_seconds{target=~"google.com"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:39:24,952 - src.mimir_integration - ERROR - Failed to create baseline for avg_over_time(network_packet_loss_ratio{target=~"google.com"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:39:24,952 - src.mimir_integration - ERROR - Failed to create baseline for avg_over_time(network_jitter_seconds{target=~"google.com"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:39:24,952 - src.mimir_integration - ERROR - Failed to create baseline for avg_over_time(network_mos_score{target=~"google.com"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:39:24,952 - src.mimir_integration - ERROR - Failed to create baseline for avg_over_time(network_tcp_handshake_duration_seconds{target=~"google.com"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:39:24,952 - src.mimir_integration - ERROR - Failed to create baseline for avg_over_time(network_dns_resolution_duration_seconds{target=~"google.com"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:39:24,952 - src.mimir_integration - ERROR - Failed to create baseline for avg_over_time(network_http_response_duration_seconds{target=~"google.com"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:39:24,952 - src.mimir_integration - ERROR - Failed to create baseline for rate(network_connection_errors_total{target=~"google.com"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:39:24,952 - src.mimir_integration - ERROR - Failed to create baseline for avg_over_time(network_interface_utilization_ratio{interface=~".*"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:39:24,952 - src.mimir_integration - ERROR - Failed to create baseline for avg_over_time(network_icmp_ping_duration_seconds{target=~"github.com"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:39:24,952 - src.mimir_integration - ERROR - Failed to create baseline for avg_over_time(network_packet_loss_ratio{target=~"github.com"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:39:24,952 - src.mimir_integration - ERROR - Failed to create baseline for avg_over_time(network_jitter_seconds{target=~"github.com"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:39:24,952 - src.mimir_integration - ERROR - Failed to create baseline for avg_over_time(network_mos_score{target=~"github.com"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:39:24,952 - src.mimir_integration - ERROR - Failed to create baseline for avg_over_time(network_tcp_handshake_duration_seconds{target=~"github.com"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:39:24,952 - src.mimir_integration - ERROR - Failed to create baseline for avg_over_time(network_dns_resolution_duration_seconds{target=~"github.com"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:39:24,952 - src.mimir_integration - ERROR - Failed to create baseline for avg_over_time(network_http_response_duration_seconds{target=~"github.com"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:39:24,952 - src.mimir_integration - ERROR - Failed to create baseline for rate(network_connection_errors_total{target=~"github.com"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:39:24,952 - src.mimir_integration - ERROR - Failed to create baseline for avg_over_time(network_interface_utilization_ratio{interface=~".*"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:39:36,475 - __main__ - INFO - Received signal 2, initiating graceful shutdown...
2025-06-04 08:39:36,475 - __main__ - INFO - Stopping Enhanced Network Intelligence Monitor...
2025-06-04 08:39:36,476 - src.dynamic_thresh - INFO - Dynamic threshold adjustment stopped
2025-06-04 08:39:41,476 - src.alerts - INFO - Alert management system stopped
2025-06-04 08:39:46,476 - src.prom_export - INFO - Metrics aggregator stopped
2025-06-04 08:39:46,477 - src.prom_export - INFO - Prometheus metrics server stopped
2025-06-04 08:39:46,477 - websockets.server - INFO - server closing
2025-06-04 08:39:46,478 - websockets.server - INFO - connection rejected (503 Service Unavailable)
2025-06-04 08:39:46,478 - websockets.server - INFO - connection rejected (503 Service Unavailable)
2025-06-04 08:39:46,479 - websockets.server - INFO - server closed
2025-06-04 08:39:46,479 - src.websocket_server - INFO - WebSocket server stopped
2025-06-04 08:39:46,481 - src.utils.database - INFO - Database connection closed
2025-06-04 08:39:46,481 - ai - INFO - Model enhanced_lstm saved to data/models (0.00MB)
2025-06-04 08:39:46,481 - __main__ - INFO - AI models saved
2025-06-04 08:39:46,481 - __main__ - INFO - === Final Performance Report ===
2025-06-04 08:39:46,481 - __main__ - INFO - System Uptime: 0.01 hours
2025-06-04 08:39:46,481 - __main__ - INFO - Total Measurements: 0
2025-06-04 08:39:46,481 - __main__ - INFO - Anomalies Detected: 0
2025-06-04 08:39:46,481 - __main__ - INFO - Alerts Sent: 0
2025-06-04 08:39:46,481 - __main__ - INFO - Model Trainings: 0
2025-06-04 08:39:46,481 - __main__ - INFO - Baseline Updates: 0
2025-06-04 08:39:46,481 - __main__ - INFO - Average Collection Time: 0.00s
2025-06-04 08:39:46,482 - __main__ - INFO - Final Health Score: 100.0
2025-06-04 08:39:46,482 - __main__ - INFO - ================================
2025-06-04 08:39:46,482 - __main__ - INFO - Enhanced Network Intelligence Monitor stopped
2025-06-04 08:40:08,799 - __main__ - INFO - Received signal 2, initiating graceful shutdown...
2025-06-04 08:40:15,675 - __main__ - INFO - Received signal 2, initiating graceful shutdown...
2025-06-04 08:40:26,798 - __main__ - INFO - Received signal 15, initiating graceful shutdown...
2025-06-04 08:40:39,201 - __main__ - INFO - Received signal 15, initiating graceful shutdown...
2025-06-04 08:43:59,679 - src.utils.logger - INFO - Logging system initialized
2025-06-04 08:43:59,679 - src.utils.logger - INFO - Log level: 20
2025-06-04 08:43:59,679 - src.utils.logger - INFO - Log file: data/logs/network_intelligence.log
2025-06-04 08:43:59,679 - __main__ - INFO - Initializing Enhanced Network Intelligence Monitor with Alloy‚ÜíMimir integration...
2025-06-04 08:43:59,680 - src.config - INFO - Loaded configuration from config.yaml
2025-06-04 08:43:59,680 - src.config - INFO - Configuration validation completed
2025-06-04 08:43:59,680 - __main__ - INFO - Configuration loaded from: config.yaml
2025-06-04 08:43:59,680 - __main__ - INFO - Monitoring targets: ['8.8.8.8', '1.1.1.1', 'google.com', 'github.com']
2025-06-04 08:43:59,680 - __main__ - INFO - Monitoring interval: 30s
2025-06-04 08:43:59,680 - __main__ - INFO - AI features enabled: True
2025-06-04 08:43:59,680 - __main__ - INFO - Edge optimization: False
2025-06-04 08:43:59,680 - __main__ - INFO - Mimir enabled: True
2025-06-04 08:43:59,682 - __main__ - INFO - Environment detection:
2025-06-04 08:43:59,682 - __main__ - INFO -   Platform: linux
2025-06-04 08:43:59,682 - __main__ - INFO -   Is container: True
2025-06-04 08:43:59,682 - __main__ - INFO -   Is cloud: False
2025-06-04 08:43:59,682 - __main__ - INFO -   Is edge device: False
2025-06-04 08:43:59,682 - __main__ - INFO -   Constraints: ['container_limits']
2025-06-04 08:43:59,684 - src.utils.database - INFO - Database tables created
2025-06-04 08:43:59,684 - src.utils.database - INFO - Database indexes created
2025-06-04 08:43:59,684 - src.utils.database - INFO - Database initialized: data/database/network_intelligence.db
2025-06-04 08:43:59,684 - __main__ - INFO - Database initialized: data/database/network_intelligence.db
2025-06-04 08:43:59,684 - src.collector - INFO - Enhanced network collector initialized
2025-06-04 08:43:59,684 - __main__ - INFO - Enhanced network collector initialized
2025-06-04 08:44:00,163 - src.lstm_auto - INFO - Enhanced LSTM anomaly detector initialized
2025-06-04 08:44:00,163 - ai - INFO - Model enhanced_lstm loaded from data/models
2025-06-04 08:44:00,164 - __main__ - INFO - Loaded existing AI models
2025-06-04 08:44:00,164 - __main__ - INFO - AI detection system initialized
2025-06-04 08:44:00,164 - src.mimir_integration - INFO - Mimir client initialized
2025-06-04 08:44:00,164 - __main__ - INFO - Mimir connectivity: {'mimir': {'status': 'error', 'error': '$%7BMIMIR_URL%7D/api/v1/query'}}
2025-06-04 08:44:00,164 - src.mimir_integration - INFO - Fetching historical baselines from Mimir...
2025-06-04 08:44:00,164 - src.mimir_integration - INFO - Creating baselines from 30 days of historical data
2025-06-04 08:44:00,164 - src.mimir_integration - ERROR - Failed to create baseline for avg_over_time(network_icmp_ping_duration_seconds{target=~"8.8.8.8"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:44:00,164 - src.mimir_integration - ERROR - Failed to create baseline for avg_over_time(network_packet_loss_ratio{target=~"8.8.8.8"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:44:00,164 - src.mimir_integration - ERROR - Failed to create baseline for avg_over_time(network_jitter_seconds{target=~"8.8.8.8"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:44:00,164 - src.mimir_integration - ERROR - Failed to create baseline for avg_over_time(network_mos_score{target=~"8.8.8.8"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:44:00,164 - src.mimir_integration - ERROR - Failed to create baseline for avg_over_time(network_tcp_handshake_duration_seconds{target=~"8.8.8.8"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:44:00,164 - src.mimir_integration - ERROR - Failed to create baseline for avg_over_time(network_dns_resolution_duration_seconds{target=~"8.8.8.8"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:44:00,164 - src.mimir_integration - ERROR - Failed to create baseline for avg_over_time(network_http_response_duration_seconds{target=~"8.8.8.8"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:44:00,164 - src.mimir_integration - ERROR - Failed to create baseline for rate(network_connection_errors_total{target=~"8.8.8.8"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:44:00,164 - src.mimir_integration - ERROR - Failed to create baseline for avg_over_time(network_interface_utilization_ratio{interface=~".*"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:44:00,164 - src.mimir_integration - ERROR - Failed to create baseline for avg_over_time(network_icmp_ping_duration_seconds{target=~"1.1.1.1"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:44:00,164 - src.mimir_integration - ERROR - Failed to create baseline for avg_over_time(network_packet_loss_ratio{target=~"1.1.1.1"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:44:00,164 - src.mimir_integration - ERROR - Failed to create baseline for avg_over_time(network_jitter_seconds{target=~"1.1.1.1"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:44:00,164 - src.mimir_integration - ERROR - Failed to create baseline for avg_over_time(network_mos_score{target=~"1.1.1.1"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:44:00,164 - src.mimir_integration - ERROR - Failed to create baseline for avg_over_time(network_tcp_handshake_duration_seconds{target=~"1.1.1.1"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:44:00,164 - src.mimir_integration - ERROR - Failed to create baseline for avg_over_time(network_dns_resolution_duration_seconds{target=~"1.1.1.1"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:44:00,164 - src.mimir_integration - ERROR - Failed to create baseline for avg_over_time(network_http_response_duration_seconds{target=~"1.1.1.1"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:44:00,164 - src.mimir_integration - ERROR - Failed to create baseline for rate(network_connection_errors_total{target=~"1.1.1.1"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:44:00,164 - src.mimir_integration - ERROR - Failed to create baseline for avg_over_time(network_interface_utilization_ratio{interface=~".*"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:44:00,164 - src.mimir_integration - ERROR - Failed to create baseline for avg_over_time(network_icmp_ping_duration_seconds{target=~"google.com"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:44:00,164 - src.mimir_integration - ERROR - Failed to create baseline for avg_over_time(network_packet_loss_ratio{target=~"google.com"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:44:00,164 - src.mimir_integration - ERROR - Failed to create baseline for avg_over_time(network_jitter_seconds{target=~"google.com"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:44:00,164 - src.mimir_integration - ERROR - Failed to create baseline for avg_over_time(network_mos_score{target=~"google.com"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:44:00,164 - src.mimir_integration - ERROR - Failed to create baseline for avg_over_time(network_tcp_handshake_duration_seconds{target=~"google.com"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:44:00,164 - src.mimir_integration - ERROR - Failed to create baseline for avg_over_time(network_dns_resolution_duration_seconds{target=~"google.com"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:44:00,164 - src.mimir_integration - ERROR - Failed to create baseline for avg_over_time(network_http_response_duration_seconds{target=~"google.com"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:44:00,164 - src.mimir_integration - ERROR - Failed to create baseline for rate(network_connection_errors_total{target=~"google.com"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:44:00,164 - src.mimir_integration - ERROR - Failed to create baseline for avg_over_time(network_interface_utilization_ratio{interface=~".*"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:44:00,165 - src.mimir_integration - ERROR - Failed to create baseline for avg_over_time(network_icmp_ping_duration_seconds{target=~"github.com"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:44:00,165 - src.mimir_integration - ERROR - Failed to create baseline for avg_over_time(network_packet_loss_ratio{target=~"github.com"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:44:00,165 - src.mimir_integration - ERROR - Failed to create baseline for avg_over_time(network_jitter_seconds{target=~"github.com"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:44:00,165 - src.mimir_integration - ERROR - Failed to create baseline for avg_over_time(network_mos_score{target=~"github.com"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:44:00,165 - src.mimir_integration - ERROR - Failed to create baseline for avg_over_time(network_tcp_handshake_duration_seconds{target=~"github.com"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:44:00,165 - src.mimir_integration - ERROR - Failed to create baseline for avg_over_time(network_dns_resolution_duration_seconds{target=~"github.com"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:44:00,165 - src.mimir_integration - ERROR - Failed to create baseline for avg_over_time(network_http_response_duration_seconds{target=~"github.com"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:44:00,165 - src.mimir_integration - ERROR - Failed to create baseline for rate(network_connection_errors_total{target=~"github.com"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:44:00,165 - src.mimir_integration - ERROR - Failed to create baseline for avg_over_time(network_interface_utilization_ratio{interface=~".*"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:44:00,165 - src.mimir_integration - WARNING - No baselines retrieved from Mimir
2025-06-04 08:44:00,165 - __main__ - INFO - Mimir integration initialized
2025-06-04 08:44:00,165 - src.alerts - INFO - Loaded 0 escalation rules
2025-06-04 08:44:00,165 - src.alerts - INFO - Alert management system started
2025-06-04 08:44:00,165 - __main__ - INFO - Alerting system initialized
2025-06-04 08:44:00,165 - src.dynamic_thresh - INFO - Initialized dynamic thresholds for 10 metrics
2025-06-04 08:44:00,165 - __main__ - INFO - Dynamic threshold management initialized
2025-06-04 08:44:00,166 - src.prom_export - INFO - Prometheus metrics server started on 0.0.0.0:8540
2025-06-04 08:44:00,166 - src.prom_export - INFO - Metrics aggregator started
2025-06-04 08:44:00,166 - __main__ - INFO - Prometheus metrics server started on port 8540 for Alloy to scrape
2025-06-04 08:44:00,170 - __main__ - INFO - Enhanced API server initialized
2025-06-04 08:44:00,173 - websockets.server - INFO - server listening on 0.0.0.0:8001
2025-06-04 08:44:00,173 - src.websocket_server - INFO - WebSocket server started on ws://0.0.0.0:8001
2025-06-04 08:44:00,173 - __main__ - INFO - WebSocket server initialized on port 8001
2025-06-04 08:44:00,173 - __main__ - INFO - Verifying Alloy‚ÜíMimir integration setup...
2025-06-04 08:44:00,175 - __main__ - INFO - ‚úì Metrics export endpoint working
2025-06-04 08:44:00,175 - __main__ - WARNING - ‚úó Mimir connectivity failed
2025-06-04 08:44:00,175 - __main__ - INFO - ‚úì Alloy configuration file found
2025-06-04 08:44:00,175 - __main__ - WARNING - ‚ö†Ô∏è  Integration setup partially working: 2/3 components operational
2025-06-04 08:44:00,175 - __main__ - INFO - üìã Check Mimir URL and tenant configuration
2025-06-04 08:44:00,175 - __main__ - INFO - Enhanced Network Intelligence Monitor initialization complete
2025-06-04 08:44:00,175 - __main__ - INFO - Starting Enhanced Network Intelligence Monitor...
2025-06-04 08:44:00,175 - __main__ - INFO - Enhanced Network Intelligence Monitor started successfully
2025-06-04 08:44:00,175 - __main__ - INFO - === Enhanced Network Intelligence Monitor Started ===
2025-06-04 08:44:00,175 - __main__ - INFO - API Server: http://0.0.0.0:5000
2025-06-04 08:44:00,175 - __main__ - INFO - Metrics Export (for Alloy): http://0.0.0.0:8540/metrics
2025-06-04 08:44:00,176 - __main__ - INFO - WebSocket Server: ws://0.0.0.0:8001/ws
2025-06-04 08:44:00,176 - __main__ - INFO - Targets: 8.8.8.8, 1.1.1.1, google.com, github.com
2025-06-04 08:44:00,176 - __main__ - INFO - AI Detection: Enabled
2025-06-04 08:44:00,176 - __main__ - INFO - Mimir Integration: Enabled
2025-06-04 08:44:00,176 - __main__ - INFO - Edge Optimization: Disabled
2025-06-04 08:44:00,176 - __main__ - INFO - Alerting: Enabled
2025-06-04 08:44:00,176 - __main__ - INFO - =====================================================
2025-06-04 08:44:00,176 - __main__ - INFO - üìä Data Flow: Monitor ‚Üí Alloy (scrapes :8000/metrics) ‚Üí Mimir
2025-06-04 08:44:00,176 - __main__ - INFO - Main monitoring loop started
2025-06-04 08:44:00,176 - __main__ - INFO - Updating baselines from Mimir...
2025-06-04 08:44:00,176 - src.api.server - INFO - Starting API server on 0.0.0.0:5000
2025-06-04 08:44:00,176 - src.mimir_integration - INFO - Creating baselines from 7 days of historical data
2025-06-04 08:44:00,176 - src.mimir_integration - ERROR - Failed to create baseline for avg_over_time(network_icmp_ping_duration_seconds{target=~"8.8.8.8"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:44:00,176 - src.mimir_integration - ERROR - Failed to create baseline for avg_over_time(network_packet_loss_ratio{target=~"8.8.8.8"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:44:00,176 - src.mimir_integration - ERROR - Failed to create baseline for avg_over_time(network_jitter_seconds{target=~"8.8.8.8"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:44:00,176 - src.mimir_integration - ERROR - Failed to create baseline for avg_over_time(network_mos_score{target=~"8.8.8.8"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:44:00,176 - src.mimir_integration - ERROR - Failed to create baseline for avg_over_time(network_tcp_handshake_duration_seconds{target=~"8.8.8.8"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:44:00,176 - src.mimir_integration - ERROR - Failed to create baseline for avg_over_time(network_dns_resolution_duration_seconds{target=~"8.8.8.8"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:44:00,176 - src.mimir_integration - ERROR - Failed to create baseline for avg_over_time(network_http_response_duration_seconds{target=~"8.8.8.8"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:44:00,176 - src.mimir_integration - ERROR - Failed to create baseline for rate(network_connection_errors_total{target=~"8.8.8.8"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:44:00,176 - src.mimir_integration - ERROR - Failed to create baseline for avg_over_time(network_interface_utilization_ratio{interface=~".*"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:44:00,176 - src.mimir_integration - ERROR - Failed to create baseline for avg_over_time(network_icmp_ping_duration_seconds{target=~"1.1.1.1"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:44:00,177 - src.mimir_integration - ERROR - Failed to create baseline for avg_over_time(network_packet_loss_ratio{target=~"1.1.1.1"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:44:00,177 - src.mimir_integration - ERROR - Failed to create baseline for avg_over_time(network_jitter_seconds{target=~"1.1.1.1"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:44:00,177 - src.mimir_integration - ERROR - Failed to create baseline for avg_over_time(network_mos_score{target=~"1.1.1.1"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:44:00,177 - src.mimir_integration - ERROR - Failed to create baseline for avg_over_time(network_tcp_handshake_duration_seconds{target=~"1.1.1.1"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:44:00,177 - src.mimir_integration - ERROR - Failed to create baseline for avg_over_time(network_dns_resolution_duration_seconds{target=~"1.1.1.1"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:44:00,177 - src.mimir_integration - ERROR - Failed to create baseline for avg_over_time(network_http_response_duration_seconds{target=~"1.1.1.1"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:44:00,177 - src.mimir_integration - ERROR - Failed to create baseline for rate(network_connection_errors_total{target=~"1.1.1.1"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:44:00,177 - src.mimir_integration - ERROR - Failed to create baseline for avg_over_time(network_interface_utilization_ratio{interface=~".*"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:44:00,177 - src.mimir_integration - ERROR - Failed to create baseline for avg_over_time(network_icmp_ping_duration_seconds{target=~"google.com"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:44:00,177 - src.mimir_integration - ERROR - Failed to create baseline for avg_over_time(network_packet_loss_ratio{target=~"google.com"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:44:00,177 - src.mimir_integration - ERROR - Failed to create baseline for avg_over_time(network_jitter_seconds{target=~"google.com"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:44:00,177 - src.mimir_integration - ERROR - Failed to create baseline for avg_over_time(network_mos_score{target=~"google.com"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:44:00,177 - src.mimir_integration - ERROR - Failed to create baseline for avg_over_time(network_tcp_handshake_duration_seconds{target=~"google.com"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:44:00,177 - src.mimir_integration - ERROR - Failed to create baseline for avg_over_time(network_dns_resolution_duration_seconds{target=~"google.com"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:44:00,177 - src.mimir_integration - ERROR - Failed to create baseline for avg_over_time(network_http_response_duration_seconds{target=~"google.com"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:44:00,177 - src.mimir_integration - ERROR - Failed to create baseline for rate(network_connection_errors_total{target=~"google.com"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:44:00,177 - src.mimir_integration - ERROR - Failed to create baseline for avg_over_time(network_interface_utilization_ratio{interface=~".*"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:44:00,177 - src.mimir_integration - ERROR - Failed to create baseline for avg_over_time(network_icmp_ping_duration_seconds{target=~"github.com"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:44:00,177 - src.mimir_integration - ERROR - Failed to create baseline for avg_over_time(network_packet_loss_ratio{target=~"github.com"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:44:00,177 - src.mimir_integration - ERROR - Failed to create baseline for avg_over_time(network_jitter_seconds{target=~"github.com"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:44:00,177 - src.mimir_integration - ERROR - Failed to create baseline for avg_over_time(network_mos_score{target=~"github.com"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:44:00,177 - src.mimir_integration - ERROR - Failed to create baseline for avg_over_time(network_tcp_handshake_duration_seconds{target=~"github.com"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:44:00,177 - src.mimir_integration - ERROR - Failed to create baseline for avg_over_time(network_dns_resolution_duration_seconds{target=~"github.com"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:44:00,177 - src.mimir_integration - ERROR - Failed to create baseline for avg_over_time(network_http_response_duration_seconds{target=~"github.com"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:44:00,177 - src.mimir_integration - ERROR - Failed to create baseline for rate(network_connection_errors_total{target=~"github.com"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:44:00,177 - src.mimir_integration - ERROR - Failed to create baseline for avg_over_time(network_interface_utilization_ratio{interface=~".*"}[5m]): 'MimirClient' object has no attribute '_process_baseline_query'
2025-06-04 08:44:10,189 - websockets.server - INFO - connection rejected (426 Upgrade Required)
2025-06-04 08:44:10,191 - websockets.server - ERROR - opening handshake failed
Traceback (most recent call last):
  File "/opt/network-monitor-ml/venv/lib/python3.12/site-packages/websockets/asyncio/server.py", line 356, in conn_handler
    await connection.handshake(
  File "/opt/network-monitor-ml/venv/lib/python3.12/site-packages/websockets/asyncio/server.py", line 207, in handshake
    raise self.protocol.handshake_exc
  File "/opt/network-monitor-ml/venv/lib/python3.12/site-packages/websockets/server.py", line 138, in accept
    ) = self.process_request(request)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/network-monitor-ml/venv/lib/python3.12/site-packages/websockets/server.py", line 233, in process_request
    raise InvalidUpgrade(
websockets.exceptions.InvalidUpgrade: missing Connection header
2025-06-04 08:44:12,774 - websockets.server - INFO - connection rejected (426 Upgrade Required)
2025-06-04 08:44:12,778 - websockets.server - ERROR - opening handshake failed
Traceback (most recent call last):
  File "/opt/network-monitor-ml/venv/lib/python3.12/site-packages/websockets/asyncio/server.py", line 356, in conn_handler
    await connection.handshake(
  File "/opt/network-monitor-ml/venv/lib/python3.12/site-packages/websockets/asyncio/server.py", line 207, in handshake
    raise self.protocol.handshake_exc
  File "/opt/network-monitor-ml/venv/lib/python3.12/site-packages/websockets/server.py", line 138, in accept
    ) = self.process_request(request)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/network-monitor-ml/venv/lib/python3.12/site-packages/websockets/server.py", line 233, in process_request
    raise InvalidUpgrade(
websockets.exceptions.InvalidUpgrade: missing Connection header
2025-06-04 08:44:19,407 - src.dynamic_thresh - INFO - Initialized threshold for new metric timestamp: 2623539960.2642503
2025-06-04 08:44:19,408 - src.dynamic_thresh - INFO - Initialized threshold for new metric tcp_connect_time: 10.0
2025-06-04 08:44:19,408 - src.dynamic_thresh - INFO - Initialized threshold for new metric tcp_ssl_handshake_time: 10.0
2025-06-04 08:44:19,408 - src.dynamic_thresh - INFO - Initialized threshold for new metric http_first_byte_time: 10.0
2025-06-04 08:44:19,408 - src.dynamic_thresh - INFO - Initialized threshold for new metric burst_loss_rate: 10.0
2025-06-04 08:44:19,408 - src.dynamic_thresh - INFO - Initialized threshold for new metric out_of_order_packets: 10.0
2025-06-04 08:44:19,408 - src.dynamic_thresh - INFO - Initialized threshold for new metric duplicate_packets: 10.0
2025-06-04 08:44:19,408 - src.dynamic_thresh - INFO - Initialized threshold for new metric bandwidth_upload: 10.0
2025-06-04 08:44:19,408 - src.dynamic_thresh - INFO - Initialized threshold for new metric concurrent_connections: 11
2025-06-04 08:44:19,408 - src.dynamic_thresh - INFO - Initialized threshold for new metric connection_setup_rate: 10.0
2025-06-04 08:44:19,408 - src.dynamic_thresh - INFO - Initialized threshold for new metric http_status_code: 10
2025-06-04 08:44:19,408 - src.dynamic_thresh - INFO - Initialized threshold for new metric http_content_length: 10
2025-06-04 08:44:19,408 - src.dynamic_thresh - INFO - Initialized threshold for new metric certificate_days_remaining: 10
2025-06-04 08:44:19,408 - src.dynamic_thresh - INFO - Initialized threshold for new metric redirect_count: 10
2025-06-04 08:44:19,408 - src.dynamic_thresh - INFO - Initialized threshold for new metric interface_utilization: 10.0
2025-06-04 08:44:19,408 - src.dynamic_thresh - INFO - Initialized threshold for new metric interface_drops: 7795795.5
2025-06-04 08:44:19,408 - src.dynamic_thresh - INFO - Initialized threshold for new metric interface_collisions: 10
2025-06-04 08:44:19,408 - src.dynamic_thresh - INFO - Initialized threshold for new metric hop_count: 17
2025-06-04 08:44:19,408 - src.dynamic_thresh - INFO - Initialized threshold for new metric path_mtu: 2244.0
2025-06-04 08:44:19,408 - src.dynamic_thresh - INFO - Initialized threshold for new metric route_changes: 10
2025-06-04 08:44:19,408 - src.dynamic_thresh - INFO - Initialized threshold for new metric r_factor: 141.2845
2025-06-04 08:44:19,408 - src.dynamic_thresh - INFO - Initialized threshold for new metric delay_variation: 10.11157458890307
2025-06-04 08:44:19,408 - src.dynamic_thresh - INFO - Initialized threshold for new metric dns_errors: 10
2025-06-04 08:44:19,408 - src.dynamic_thresh - INFO - Initialized threshold for new metric timeout_errors: 10
2025-06-04 08:44:19,408 - src.dynamic_thresh - INFO - Initialized threshold for new metric measurement_duration: 28844.493985176086
2025-06-04 08:44:38,380 - websockets.server - INFO - connection rejected (426 Upgrade Required)
2025-06-04 08:44:38,382 - websockets.server - ERROR - opening handshake failed
Traceback (most recent call last):
  File "/opt/network-monitor-ml/venv/lib/python3.12/site-packages/websockets/asyncio/server.py", line 356, in conn_handler
    await connection.handshake(
  File "/opt/network-monitor-ml/venv/lib/python3.12/site-packages/websockets/asyncio/server.py", line 207, in handshake
    raise self.protocol.handshake_exc
  File "/opt/network-monitor-ml/venv/lib/python3.12/site-packages/websockets/server.py", line 138, in accept
    ) = self.process_request(request)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/network-monitor-ml/venv/lib/python3.12/site-packages/websockets/server.py", line 233, in process_request
    raise InvalidUpgrade(
websockets.exceptions.InvalidUpgrade: missing Connection header
2025-06-04 08:44:42,773 - websockets.server - INFO - connection rejected (426 Upgrade Required)
2025-06-04 08:44:42,774 - websockets.server - ERROR - opening handshake failed
Traceback (most recent call last):
  File "/opt/network-monitor-ml/venv/lib/python3.12/site-packages/websockets/asyncio/server.py", line 356, in conn_handler
    await connection.handshake(
  File "/opt/network-monitor-ml/venv/lib/python3.12/site-packages/websockets/asyncio/server.py", line 207, in handshake
    raise self.protocol.handshake_exc
  File "/opt/network-monitor-ml/venv/lib/python3.12/site-packages/websockets/server.py", line 138, in accept
    ) = self.process_request(request)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/network-monitor-ml/venv/lib/python3.12/site-packages/websockets/server.py", line 233, in process_request
    raise InvalidUpgrade(
websockets.exceptions.InvalidUpgrade: missing Connection header
2025-06-04 08:45:08,382 - websockets.server - INFO - connection rejected (426 Upgrade Required)
2025-06-04 08:45:08,384 - websockets.server - ERROR - opening handshake failed
Traceback (most recent call last):
  File "/opt/network-monitor-ml/venv/lib/python3.12/site-packages/websockets/asyncio/server.py", line 356, in conn_handler
    await connection.handshake(
  File "/opt/network-monitor-ml/venv/lib/python3.12/site-packages/websockets/asyncio/server.py", line 207, in handshake
    raise self.protocol.handshake_exc
  File "/opt/network-monitor-ml/venv/lib/python3.12/site-packages/websockets/server.py", line 138, in accept
    ) = self.process_request(request)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/network-monitor-ml/venv/lib/python3.12/site-packages/websockets/server.py", line 233, in process_request
    raise InvalidUpgrade(
websockets.exceptions.InvalidUpgrade: missing Connection header
2025-06-04 08:45:12,773 - websockets.server - INFO - connection rejected (426 Upgrade Required)
2025-06-04 08:45:12,774 - websockets.server - ERROR - opening handshake failed
Traceback (most recent call last):
  File "/opt/network-monitor-ml/venv/lib/python3.12/site-packages/websockets/asyncio/server.py", line 356, in conn_handler
    await connection.handshake(
  File "/opt/network-monitor-ml/venv/lib/python3.12/site-packages/websockets/asyncio/server.py", line 207, in handshake
    raise self.protocol.handshake_exc
  File "/opt/network-monitor-ml/venv/lib/python3.12/site-packages/websockets/server.py", line 138, in accept
    ) = self.process_request(request)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/network-monitor-ml/venv/lib/python3.12/site-packages/websockets/server.py", line 233, in process_request
    raise InvalidUpgrade(
websockets.exceptions.InvalidUpgrade: missing Connection header
2025-06-04 08:45:38,381 - websockets.server - INFO - connection rejected (426 Upgrade Required)
2025-06-04 08:45:38,382 - websockets.server - ERROR - opening handshake failed
Traceback (most recent call last):
  File "/opt/network-monitor-ml/venv/lib/python3.12/site-packages/websockets/asyncio/server.py", line 356, in conn_handler
    await connection.handshake(
  File "/opt/network-monitor-ml/venv/lib/python3.12/site-packages/websockets/asyncio/server.py", line 207, in handshake
    raise self.protocol.handshake_exc
  File "/opt/network-monitor-ml/venv/lib/python3.12/site-packages/websockets/server.py", line 138, in accept
    ) = self.process_request(request)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/network-monitor-ml/venv/lib/python3.12/site-packages/websockets/server.py", line 233, in process_request
    raise InvalidUpgrade(
websockets.exceptions.InvalidUpgrade: missing Connection header
2025-06-04 08:45:42,773 - websockets.server - INFO - connection rejected (426 Upgrade Required)
2025-06-04 08:45:42,775 - websockets.server - ERROR - opening handshake failed
Traceback (most recent call last):
  File "/opt/network-monitor-ml/venv/lib/python3.12/site-packages/websockets/asyncio/server.py", line 356, in conn_handler
    await connection.handshake(
  File "/opt/network-monitor-ml/venv/lib/python3.12/site-packages/websockets/asyncio/server.py", line 207, in handshake
    raise self.protocol.handshake_exc
  File "/opt/network-monitor-ml/venv/lib/python3.12/site-packages/websockets/server.py", line 138, in accept
    ) = self.process_request(request)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/network-monitor-ml/venv/lib/python3.12/site-packages/websockets/server.py", line 233, in process_request
    raise InvalidUpgrade(
websockets.exceptions.InvalidUpgrade: missing Connection header
2025-06-04 08:45:46,906 - __main__ - INFO - Starting periodic AI training...
2025-06-04 08:45:46,906 - __main__ - INFO - Insufficient training data: 10 samples
2025-06-04 08:46:08,381 - websockets.server - INFO - connection rejected (426 Upgrade Required)
2025-06-04 08:46:08,382 - websockets.server - ERROR - opening handshake failed
Traceback (most recent call last):
  File "/opt/network-monitor-ml/venv/lib/python3.12/site-packages/websockets/asyncio/server.py", line 356, in conn_handler
    await connection.handshake(
  File "/opt/network-monitor-ml/venv/lib/python3.12/site-packages/websockets/asyncio/server.py", line 207, in handshake
    raise self.protocol.handshake_exc
  File "/opt/network-monitor-ml/venv/lib/python3.12/site-packages/websockets/server.py", line 138, in accept
    ) = self.process_request(request)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/network-monitor-ml/venv/lib/python3.12/site-packages/websockets/server.py", line 233, in process_request
    raise InvalidUpgrade(
websockets.exceptions.InvalidUpgrade: missing Connection header
2025-06-04 08:46:12,774 - websockets.server - INFO - connection rejected (426 Upgrade Required)
2025-06-04 08:46:12,775 - websockets.server - ERROR - opening handshake failed
Traceback (most recent call last):
  File "/opt/network-monitor-ml/venv/lib/python3.12/site-packages/websockets/asyncio/server.py", line 356, in conn_handler
    await connection.handshake(
  File "/opt/network-monitor-ml/venv/lib/python3.12/site-packages/websockets/asyncio/server.py", line 207, in handshake
    raise self.protocol.handshake_exc
  File "/opt/network-monitor-ml/venv/lib/python3.12/site-packages/websockets/server.py", line 138, in accept
    ) = self.process_request(request)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/network-monitor-ml/venv/lib/python3.12/site-packages/websockets/server.py", line 233, in process_request
    raise InvalidUpgrade(
websockets.exceptions.InvalidUpgrade: missing Connection header
2025-06-04 08:46:32,191 - __main__ - INFO - Received signal 2, initiating graceful shutdown...
2025-06-04 08:46:32,191 - __main__ - INFO - Stopping Enhanced Network Intelligence Monitor...
2025-06-04 08:46:32,191 - src.dynamic_thresh - INFO - Dynamic threshold adjustment stopped
2025-06-04 08:46:33,211 - __main__ - INFO - Received signal 2, initiating graceful shutdown...
2025-06-04 08:46:37,192 - src.alerts - INFO - Alert management system stopped
2025-06-04 08:46:42,192 - src.prom_export - INFO - Metrics aggregator stopped
2025-06-04 08:46:42,192 - src.prom_export - INFO - Prometheus metrics server stopped
2025-06-04 08:46:42,193 - websockets.server - INFO - server closing
2025-06-04 08:46:42,193 - websockets.server - INFO - connection rejected (503 Service Unavailable)
2025-06-04 08:46:42,194 - websockets.server - INFO - server closed
2025-06-04 08:46:42,194 - src.websocket_server - INFO - WebSocket server stopped
2025-06-04 08:46:42,198 - src.utils.database - INFO - Database connection closed
2025-06-04 08:46:42,198 - ai - INFO - Model enhanced_lstm saved to data/models (0.00MB)
2025-06-04 08:46:42,198 - __main__ - INFO - AI models saved
2025-06-04 08:46:42,198 - __main__ - INFO - === Final Performance Report ===
2025-06-04 08:46:42,198 - __main__ - INFO - System Uptime: 0.05 hours
2025-06-04 08:46:42,198 - __main__ - INFO - Total Measurements: 7
2025-06-04 08:46:42,198 - __main__ - INFO - Anomalies Detected: 0
2025-06-04 08:46:42,198 - __main__ - INFO - Alerts Sent: 0
2025-06-04 08:46:42,198 - __main__ - INFO - Model Trainings: 0
2025-06-04 08:46:42,198 - __main__ - INFO - Baseline Updates: 0
2025-06-04 08:46:42,198 - __main__ - INFO - Average Collection Time: 10.67s
2025-06-04 08:46:42,198 - __main__ - INFO - Final Health Score: 100.0
2025-06-04 08:46:42,198 - __main__ - INFO - ================================
2025-06-04 08:46:42,198 - __main__ - INFO - Enhanced Network Intelligence Monitor stopped
